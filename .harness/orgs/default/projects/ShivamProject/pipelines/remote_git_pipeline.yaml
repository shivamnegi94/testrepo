pipeline:
  identifier: remote_git_pipeline
  name: Remote Git Pipeline
  projectIdentifier: ShivamProject
  orgIdentifier: default
  description: This pipeline was generated by Harness AI on 2025-08-12 11:51:51 UTC by shivam.negi@harness.io.
  tags:
    ai_generated: "true"
  properties:
    ci:
      codebase:
        connectorRef: <+input>
        repoName: <+input>
        build:
          type: branch
          spec:
            branch: <+input>
  variables:
    - name: git_connector
      type: String
      value: <+input>
    - name: repo_name
      type: String
      value: <+input>
    - name: file_path
      type: String
      value: <+input>
  stages:
    - stage:
        identifier: custom_stage
        name: Custom Stage
        type: Custom
        spec:
          execution:
            steps:
              - step:
                  identifier: configure_git_connector
                  name: Configure Git Connector
                  type: ShellScript
                  timeout: 10m
                  spec:
                    shell: Bash
                    source:
                      type: Inline
                      spec:
                        script: |
                          # Configure Git connector reference for remote pipeline storage
                          echo "Setting up Git connector reference: ${GIT_CONNECTOR}"

                          # Validate the connector reference
                          if [ -z "${GIT_CONNECTOR}" ]; then
                            echo "Error: Git connector reference is empty"
                            exit 1
                          fi

                          echo "Successfully configured Git connector: ${GIT_CONNECTOR}"
                    environmentVariables:
                      - name: GIT_CONNECTOR
                        type: String
                        value: <+pipeline.variables.git_connector>
              - step:
                  identifier: set_pipeline_file_path
                  name: Set Pipeline File Path
                  type: ShellScript
                  timeout: 10m
                  spec:
                    shell: Bash
                    source:
                      type: Inline
                      spec:
                        script: |
                          # Set the file path for the pipeline definition in the Git repository
                          echo "Setting pipeline file path to: ${FILE_PATH}"

                          # Validate the file path
                          if [ -z "${FILE_PATH}" ]; then
                            echo "Error: File path is empty"
                            exit 1
                          fi

                          echo "Pipeline definition will be stored at: ${FILE_PATH}"
                    environmentVariables:
                      - name: FILE_PATH
                        type: String
                        value: <+pipeline.variables.file_path>
                    outputVariables:
                      - name: pipeline_file_path
                        type: String
                        value: FILE_PATH
            rollbackSteps: []
